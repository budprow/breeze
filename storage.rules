rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    
    // This rule applies to files inside the 'documents' folder.
    match /documents/{restaurantId}/{allPaths=**} {
    
      // Allow read and write access IF the user is authenticated AND
      // their auth token has a custom claim for 'restaurantId' that
      // matches the folder they are trying to access.
      allow read, write: if request.auth != null && request.auth.token.restaurantId == restaurantId;
    }
  }
}